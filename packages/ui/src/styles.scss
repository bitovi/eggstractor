@import './mixins.scss';

html,
body {
  margin: 0;
  padding: 0;
  font-family: $font-family-body;
  background: $colour-page-bg;
  overflow-x: hidden; // Prevent horizontal scrolling
  overflow-y: hidden; // Prevent body from scrolling - content-area will handle scrolling
  width: 100%;
  height: 100%;
}

#root {
  height: 100vh;
  overflow: hidden;
}

* {
  box-sizing: border-box;
}

img {
  display: block;
  margin: 0;
}

// Navigation styles
.navigation {
  @include eggstractor-plugin-design-export---generate-nav;

  .nav-item {
    @include eggstractor-plugin-design-export---generate-nav-nav1;
    text-decoration: none;

    &--selected {
      @include eggstractor-plugin-design-export---generate-nav-nav1-export;
    }

    &--unselected {
      @include eggstractor-plugin-design-export---generate-nav-nav2-export;
    }
  }
}

// Stepper styles
.stepper {
  @include eggstractor-plugin-design-export---generate-bottom-sheet-stepper;

  display: flex;
  align-items: center;
  width: 100%;
  max-width: 33.5rem;
  padding: 1rem 0;
  position: relative;

  .stepper-step {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    z-index: 2; // Ensure steps are above connectors

    &:not(:last-child) {
      flex: 1; // Allow space for connectors
    }

    &__circle {
      @include eggstractor-plugin-design-export---generate-bottom-sheet-stepper-stepper-step-circle;
      width: 2rem;
      height: 2rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: $colour-stepper-inactive;
      border: 2px solid $colour-stepper-inactive;
      flex-shrink: 0;

      &--active {
        background: $colour-accent;
        border-color: $colour-accent;

        .stepper-step__number {
          color: white;
        }
      }
    }

    &__number {
      @include eggstractor-plugin-design-export---generate-bottom-sheet-stepper-stepper-step-circle-1;
      font-size: 0.875rem;
      font-weight: 600;
      color: white;
    }

    &__label {
      @include eggstractor-plugin-design-export---generate-bottom-sheet-stepper-stepper-step-arrow-and-text;
      font-size: 0.875rem;
      color: $colour-text;
      margin-top: 0.5rem;
      text-align: center;
      white-space: nowrap;
    }
  }

  // Connector between steps
  .stepper-connector {
    position: absolute;
    top: 1rem; // Center with circles
    left: 2rem; // Start after first circle
    right: 2rem; // End before last circle
    height: 2px;
    z-index: 1; // Behind circles
    display: flex;
    align-items: center;
  }

  // Arrow SVG styling
  .stepper-arrow-svg {
    width: 100%;
    height: 16px;
    display: block;
  }
}

// Card styles
.card {
  @include eggstractor-plugin-design-export---generate-content-area-card;

  &--warning {
    background: $colour-card-warning-bg;
    border-color: $colour-card-warning-border;
  }
}

// Base Button styles - using the most complete button mixin as foundation
.button {
  @include eggstractor-plugin-design-export---generate-bottom-sheet-action-area-button;
  @include eggstractor-plugin-design-export---generate-bottom-sheet-action-area-button-label;

  // Common button properties that might not be in the mixin
  border: none;
  cursor: pointer;

  // Secondary button variant
  &--secondary {
    background: white;
    color: $colour-button-secondary-text-resting;
    border: 1px solid $colour-button-secondary-text-resting;

    &:hover {
      background: white;
      color: $colour-button-secondary-text-hover;
      border-color: $colour-button-secondary-text-hover;
    }
  }
}

// Export page - Publish content area copy button (overrides for icon button)
.export-page .publish-content-area .button {
  @include eggstractor-plugin-design-export---publish-content-area-button;
  @include eggstractor-plugin-design-export---publish-content-area-button-copy;
}

// Export page - View bottom sheet action area button
.export-page .bottom-sheet .action-area .button {
  @include eggstractor-plugin-design-export---view-bottom-sheet-action-area-button;
  @include eggstractor-plugin-design-export---view-bottom-sheet-action-area-button-label;
}

// Setup page - Bottom sheet buttons (overrides the base)
.setup-content + .bottom-sheet .button {
  @include eggstractor-plugin-design-setup---filled-bottom-sheet-buttons-button;

  // Override fixed width from Figma mixin
  width: auto;
  min-width: auto;
  max-width: none;
  flex: 0 0 auto; // Don't grow or shrink, use content width

  // Primary button (Save Changes) - override the incorrect text color from Setup mixin
  &:not(.button--secondary) {
    @include eggstractor-plugin-design-setup---filled-bottom-sheet-buttons-button-label;
    color: $colour-button-primary-text-resting; // Override incorrect mixin color
  }

  // Secondary button (Cancel) - use the Setup label but override background
  &.button--secondary {
    @include eggstractor-plugin-design-setup---filled-bottom-sheet-buttons-button-label;
    background: white;
    border: none;
    // Keep the teal text from the mixin
  }
}

// Complete state styles for Export page
.complete-state {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: $size-md;

  #status {
    font-size: 0.875rem;
    color: $colour-text;

    a {
      color: $colour-accent;
      text-decoration: none;

      &:hover {
        text-decoration: underline;
      }
    }
  }
}

// SegmentedButton styles
.segmented-button {
  display: flex;
  flex-direction: column;
  gap: $size-md;
  min-width: 0; // Allow flex shrinking

  &__header {
    display: flex;
    gap: 2px;
    align-items: start;
    width: 100%;
    flex-wrap: nowrap; // Prevent wrapping
  }

  &__label {
    color: $colour-input-label;
    font-family: $font-family-display;
    font-size: $size-xl;
    font-weight: 600;
    line-height: $size-xl;
    flex: 1;
    white-space: nowrap; // Prevent label wrapping
    overflow: hidden;
    text-overflow: ellipsis;
  }

  &__container {
    border: 1px solid $colour-button-segmented-unselected-border;
    border-radius: $radius-brand;
    overflow: hidden;
  }

  &__options {
    display: flex;
    width: 100%;
  }

  &__item {
    flex: 1;
    background: $colour-button-segmented-unselected-bg-resting;
    padding: $size-sm;
  }

  &__button {
    width: 100%;
    padding: 10px;
    border: none;
    border-radius: 6px;
    background: transparent;
    cursor: pointer;
    font-family: $font-family-display;
    font-size: $size-xl;
    font-weight: 600;
    line-height: $size-xl;

    &--selected {
      background: $colour-button-segmented-selected-bg;
      color: $colour-button-segmented-selected-text;
    }

    &--unselected {
      background: transparent;
      color: $colour-button-segmented-unselected-text-resting;

      &:hover {
        color: $colour-button-segmented-unselected-text-hover;
      }
    }
  }

  &__hint {
    color: $colour-input-hint;
    font-family: $font-family-body;
    font-size: 14px;
    line-height: $size-xl;
    margin: 0;
  }
}

// Setup page - Use Figma mixins for segmented buttons
.setup-content .segmented-button {
  @include eggstractor-plugin-design-setup---filled-segmented-button;

  // Override fixed width to be responsive
  width: 100%;
  max-width: 33.75rem;

  &__header {
    @include eggstractor-plugin-design-setup---filled-segmented-button-text-above;
    width: 100%;
  }

  &__label {
    @include eggstractor-plugin-design-setup---filled-segmented-button-text-above-label;
    width: 100%;
  }

  &__container {
    @include eggstractor-plugin-design-setup---filled-segmented-button-frame-19;
    width: 100%;
  }

  &__item {
    @include eggstractor-plugin-design-setup---filled-segmented-button-frame-19-item-1;
    flex: 1; // Override fixed width with flex
    width: auto;
  }

  &__button {
    width: 100%;

    &--selected {
      @include eggstractor-plugin-design-setup---filled-segmented-button-frame-19-item-1-frame-18;
      width: 100%;

      .segmented-button__button-text {
        @include eggstractor-plugin-design-setup---filled-segmented-button-frame-19-item-1-frame-18-label;
      }
    }
  }
}

// Progress Bar styles
.progress-container {
  @include eggstractor-plugin-design-export---generating-bottom-sheet-action-area;
}

.progress-bar {
  @include eggstractor-plugin-design-export---generating-bottom-sheet-action-area-frame-36;
  width: 100%;
  height: 16px;

  &__fill {
    @include eggstractor-plugin-design-export---generating-bottom-sheet-action-area-frame-36-frame-37;
    height: 100%;
    transition: width 0.3s ease;
  }
}

.progress-text {
  @include eggstractor-plugin-design-export---generating-bottom-sheet-action-area-processing-node-96---423;
}

// Layout styles
.app-container {
  // Default to Export page layout
  @include eggstractor-plugin-design-export---generate;

  // Set up proper viewport container for fixed header + scrollable content
  width: 100%;
  max-width: 37.5rem;
  height: 100vh; // Full viewport height
  max-height: 100vh; // Don't exceed viewport
  margin: 0 auto;
  overflow: hidden; // Prevent app container from scrolling
  display: flex;
  flex-direction: column;

  // Reset any potential spacing from Figma mixins
  padding: 0;
  gap: 0;

  // For Setup page specifically, use Setup mixin instead
  &:has(.setup-content) {
    @include eggstractor-plugin-design-setup---filled;

    // Override fixed dimensions for responsiveness
    width: 100%;
    max-width: 37.5rem;
    height: 100vh;
    max-height: 100vh;
    padding: 0; // Remove padding since setup-content handles it
    gap: 0;
  }
}

.content-area {
  @include eggstractor-plugin-design-export---generate-content-area;

  // Make content area the scrollable container
  flex: 1; // Take remaining space after bottom-sheet
  overflow-y: auto; // Allow vertical scrolling
  overflow-x: hidden; // Prevent horizontal scrolling

  // When content area contains publish content, use different layout
  &:has(.publish-content-area) {
    // Reset to default flex container without Figma constraints
    display: flex;
    flex-direction: column;
    gap: $size-md;
    padding: $size-xl;
    // Keep scrolling behavior
    overflow-y: auto;
    overflow-x: hidden;
  }
}

.bottom-sheet {
  @include eggstractor-plugin-design-export---generate-bottom-sheet;

  // Keep the bottom-sheet fixed at the top, not scrollable
  flex-shrink: 0; // Don't shrink
  width: 100%;
  padding: $size-xl; // Reduced from $size-3xl
  gap: $size-xl; // Reduced from $size-3xl
  position: relative; // Ensure it stays in document flow but doesn't scroll
  z-index: 10; // Keep above content
}

// Setup-specific bottom sheet styling
.setup-content + .bottom-sheet {
  @include eggstractor-plugin-design-setup---filled-bottom-sheet;

  // Position at bottom of page and stretch full width
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  width: 100vw; // Full screen width
  max-width: none; // Remove width constraint

  // Use exact Figma padding: calc(#{$size-3xl} - 0.0625rem) $size-3xl $size-3xl
  padding: calc(#{$size-3xl} - 0.0625rem) $size-3xl $size-3xl;

  z-index: 10; // Above other content
  // Keep the existing border and shadow from the mixin
}

.action-area {
  @include eggstractor-plugin-design-export---generate-bottom-sheet-action-area;
}

// Setup-specific action area styling
.setup-content + .bottom-sheet .action-area {
  @include eggstractor-plugin-design-setup---filled-bottom-sheet-buttons;

  // Center the action area within the full-width bottom sheet and center buttons vertically
  display: flex;
  flex-direction: row;
  align-items: center; // Center buttons vertically in the bottom sheet
  gap: $size-xl; // Match Figma gap
  width: 33.5rem; // Match exact Figma width
  margin: 0 auto; // Center the action area
  padding: 0; // Match Figma padding
}

// Input field styles
.input-field {
  display: flex;
  flex-direction: column;
  gap: $size-md;
  width: 100%;
  min-width: 0; // Allow flex shrinking

  &__header {
    display: flex;
    gap: 2px;
    align-items: start;
    width: 100%;
    flex-wrap: nowrap; // Prevent wrapping
  }

  &__label {
    color: $colour-input-label;
    font-family: $font-family-display;
    font-size: $size-xl;
    font-weight: 600;
    line-height: $size-xl;
    flex: 1;
    white-space: nowrap; // Prevent label wrapping
    overflow: hidden;
    text-overflow: ellipsis;
  }

  &__link {
    color: $colour-link-resting;
    font-family: $font-family-body;
    font-size: 14px;
    line-height: $size-xl;
    background: none;
    border: none;
    white-space: nowrap; // Prevent link text wrapping
    flex-shrink: 0;
    cursor: pointer;
    padding: 0;

    &:hover {
      color: $colour-link-hover;
    }
  }

  &__container {
    background: $colour-input-bg;
    border: 1px solid $colour-input-border-resting;
    border-radius: $radius-brand;
    overflow: hidden;
  }

  &__input {
    width: 100%;
    border: none;
    padding: $size-lg;
    background: transparent;
    color: $colour-input-text;
    font-family: $font-family-body;
    font-size: $size-xl;

    &:focus {
      outline: none;
    }

    &::placeholder {
      color: $colour-input-hint;
    }
  }

  &__hint {
    color: $colour-input-hint;
    font-family: $font-family-body;
    font-size: 14px;
    line-height: $size-xl;
    margin: 0;
  }
}

// Setup specific styles
.setup-content {
  @include eggstractor-plugin-design-setup---filled;

  // Override only the properties that need to be responsive
  width: 100%; // Override fixed 37.5rem
  max-width: 37.5rem;
  height: auto; // Override fixed 53.75rem
  align-items: flex-start; // Override center alignment to prevent centering form elements

  // Add necessary padding since Figma mixin has padding: 0rem
  padding: $size-3xl;

  // Add bottom padding to account for fixed bottom sheet
  padding-bottom: calc(4rem + $size-3xl);
}

// Export card content
.export-card-content {
  @include eggstractor-plugin-design-export---generate-content-area-card-the-getting-started-guide-will-walk-you-through-the-steps-for-setting-up-a-demo-project-where-you-can-test-it-all-out-;

  p {
    margin: 0 0 $size-xl 0;

    &:last-child {
      margin-bottom: 0;
    }
  }
}

// Generating state styles
.generating-state {
  width: 100%;

  .progress-container {
    width: 100%;
  }
}

// Output styles - using design system mixins
.publish-content-area {
  @include eggstractor-plugin-design-export---publish-content-area;

  // Ensure proper layout for warnings and output
  display: flex;
  flex-direction: column;
  gap: $size-md;
  width: 100%;
  min-height: 0; // Allow shrinking
  overflow: visible;

  // Ensure the output area maintains its size regardless of warnings
  #output {
    flex: 1; // Take remaining space
    min-height: 200px; // Minimum height to prevent collapse
  }
}

// Warnings styling
#warnings {
  background: $colour-card-warning-bg;
  border: 1px solid $colour-card-warning-border;
  border-radius: $radius-brand;
  padding: $size-md;
  margin-bottom: $size-md;
  flex-shrink: 0; // Don't shrink the warnings container
  width: 100%; // Ensure stable width
  box-sizing: border-box; // Include padding in width calculation

  details {
    margin: 0;
    width: 100%; // Ensure details takes full width

    summary {
      cursor: pointer;
      font-weight: 600;
      color: $colour-text;
      margin-bottom: $size-sm;
      width: 100%; // Prevent summary from affecting width
      box-sizing: border-box;

      // Ensure summary doesn't affect container size when collapsed
      &:only-child {
        margin-bottom: 0;
      }
    }

    // When details is closed, ensure it doesn't shrink
    &:not([open]) {
      summary {
        margin-bottom: 0;
      }
    }

    ul {
      margin: 0;
      padding-left: $size-xl;
      width: 100%;
      box-sizing: border-box;

      li {
        margin-bottom: $size-sm;
        color: $colour-text;

        button {
          background: none;
          border: none;
          color: $colour-accent;
          text-decoration: underline;
          cursor: pointer;
          padding: 0;
          font: inherit;

          &:hover {
            color: $colour-accent;
            opacity: 0.8;
          }
        }
      }
    }
  }
}

.code-margins {
  @include eggstractor-plugin-design-export---publish-content-area-code-margins;
  overflow-y: auto;
  box-sizing: border-box;
}

.code-sample {
  @include eggstractor-plugin-design-export---publish-content-area-code-margins-code-sample;
  font-family: 'Roboto Mono', monospace;
  white-space: pre;
  overflow: hidden;

  // Apply the content area code sample styling
  &.content-text {
    @include eggstractor-plugin-design-export---publish-content-area-code-margins-code-sample;
  }
}

.output-scrollbar {
  @include eggstractor-plugin-design-export---publish-content-area-scrollbar;
}

.scrollbar-indicator {
  @include eggstractor-plugin-design-export---publish-content-area-scrollbar-scrollbar-indicator;
  width: 0.5rem;
  height: 8.4375rem;
}

.publish-content-area .copy-button {
  @include eggstractor-plugin-design-export---publish-content-area-button;
  position: absolute;
  top: 0.625rem;
  right: 0.1875rem;
  cursor: pointer;
  z-index: 10;

  &:hover {
    background: $colour-button-icon-bg-resting;
    opacity: 0.8;
  }

  .copy-icon {
    @include eggstractor-plugin-design-export---publish-content-area-button-copy;
    width: 1.5rem;
    height: 1.5rem;
  }

  svg {
    @include eggstractor-plugin-design-export---publish-content-area-button-copy-vector;
    width: 1.5rem;
    height: 1.5rem;
    fill: none;
    stroke: $colour-button-icon-icon-resting;
  }
}

// Legacy compatibility for existing #output selector
#output {
  @extend .publish-content-area;
  position: relative;
}

// Legacy styles that might still be needed - to be cleaned up later
pre {
  margin: 0;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  padding: 10px;
}

// Highlight.js theme using design system colors (matches Figma code sample)
.hljs {
  display: block;
  overflow-x: auto;
  padding: 0;
  background: transparent;
  color: $colour-text;
  font-family: 'Roboto Mono', monospace;
}

// Comments - green
.hljs-comment,
.hljs-quote {
  color: $colour-green-500;
  font-style: italic;
}

// Keywords and language constructs - orange
.hljs-keyword,
.hljs-literal,
.hljs-symbol,
.hljs-name,
.hljs-meta,
.hljs-meta-keyword,
.hljs-tag {
  color: $colour-orange-500;
}

// Variables and identifiers - violet
.hljs-variable,
.hljs-template-variable,
.hljs-attr,
.hljs-attribute,
.hljs-builtin-name {
  color: $colour-violet-500;
}

// Properties and CSS properties - blue
.hljs-built_in,
.hljs-type,
.hljs-section,
.hljs-title,
.hljs-function {
  color: $colour-blue-500;
}

// Values, strings, and numbers - brand color
.hljs-number,
.hljs-class,
.hljs-string,
.hljs-meta-string,
.hljs-regexp,
.hljs-template-tag {
  color: $colour-brand;
}

// Default text
.hljs-subst,
.hljs-params,
.hljs-formula,
.hljs-doctag {
  color: $colour-text;
}

// Links
.hljs-link {
  color: $colour-brand;
  text-decoration: underline;
}

// Emphasis
.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}

// About page styles - using design system mixins
.about-container {
  @include eggstractor-plugin-design-about;
}

.about-content {
  @include eggstractor-plugin-design-about-side-padding;
}

.about-text {
  @include eggstractor-plugin-design-about-side-padding-text;
}

.about-description {
  @include eggstractor-plugin-design-about-side-padding-text-eggstractor-is-an-open-source-project-for-exporting-design-as-tokens-and-utility-layers--letting-developers-build-components-their-way--while-supporting-ultra-fast--designer-led-code-updates-to-styling--by-separating-structure-from-styling--eggstractor-ensures-that-design-changes-don-t-disrupt-component-architecture--and-with-automated-code-generation-for-updates--designers-can-take-control-of-their-styling-updates--allowing-for-instantaneous-design-qa-and-freeing-up-developers--who-now-only-need-to-review-a-pr-for-styling-changes---eggstractor-is-an-open-source-project-by-bitovi--need-some-help-;

  p {
    margin-bottom: 16px;

    &:last-child {
      margin-bottom: 0;
    }
  }
}

.about-links {
  @include eggstractor-plugin-design-about-side-padding-text-links;

  a {
    @include eggstractor-plugin-design-about-side-padding-text-links-link-link-text--;
    text-decoration: none;
    cursor: pointer;

    &:hover {
      text-decoration: underline;
    }
  }

  .link-separator {
    @include eggstractor-plugin-design-about-side-padding-text-links--;
  }
}

.about-cta {
  @include eggstractor-plugin-design-about-side-padding-text-cta;

  span {
    @include eggstractor-plugin-design-about-side-padding-text-cta-need-pros-to-help-design---build-your-design-system-or-app-;
  }

  a {
    @include eggstractor-plugin-design-about-side-padding-text-cta-link-link-text--;
    text-decoration: none;
    cursor: pointer;

    &:hover {
      text-decoration: underline;
    }
  }
}

.bitovi-wordmark {
  @include eggstractor-plugin-design-about-side-padding-bitovi-wordmark;
  width: 160px;
  height: 49.86px;
  overflow: hidden;
}

.getting-started-card {
  @include eggstractor-plugin-design-about-side-padding-card;

  // Override fixed width for responsiveness
  width: 100%; // Remove fixed 33.75rem width

  h3 {
    font-family: $font-family-display;
    font-size: 24px;
    font-weight: 700;
    line-height: 24px;
    color: $colour-text;
    margin: 0 0 20px 0;
  }

  p {
    font-family: $font-family-body;
    font-size: 16px;
    font-weight: 400;
    line-height: 24px;
    color: $colour-text;
    margin: 0 0 20px 0;
    width: 100%;
  }

  a {
    @include eggstractor-plugin-design-about-side-padding-text-cta-link-link-text--;
    text-decoration: none;
    cursor: pointer;

    &:hover {
      text-decoration: underline;
    }
  }
}
