<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Redirecting...</title>
    <script>
      // Get the path from the URL
      const path = window.location.pathname.split('/').filter(Boolean);
      const repo = path[0];

      const redirect = (pathname) => {
        if (pathname === window.location.pathname) {
          document.body.innerHTML = '<p>Error: 404 Page not found</p>';
          return;
        }

        window.location.href = pathname;
      };

      // Check if we're already in an infinite loop
      if (path.filter((p) => p === 'index.html').length > 1) {
        document.body.innerHTML = '<p>Error: Path not found</p>';
      } else if (path.length === 1) {
        // At repo root, redirect to main
        redirect(`/${repo}/main/`);
      } else {
        // Try the branch preview once
        const branchPath = path[1];
        redirect(`/${repo}/${branchPath}/index.html`);
      }
    </script>
  </head>
  <body>
    <p>Redirecting to preview...</p>
  </body>
</html>
